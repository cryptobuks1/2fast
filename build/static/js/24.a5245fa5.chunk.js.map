{"version":3,"sources":["components/maintenance/UploadImage.js"],"names":["UploadImage","props","onChange","e","target","name","value","setState","state","pictures","img","locationToSetup","imgBLOB","message","onDrop","bind","pictureFiles","pictureDataURLs","this","length","map","image","withIcon","buttonText","imgExtension","label","maxFileSize","pic","style","marginTop","src","width","b64","onsuccess","onerror","Image","onload","canvas","document","createElement","height","getContext","drawImage","toBlob","b64toBlob","blob","url","window","URL","createObjectURL","sentImageToDatabase","error","console","log","showMessageUploadComplete","color","alt","undefined","setTimeout","action","method","className","showNameImageUpload","showImageUpload","variant","onClick","sendImage","editImage","showImageAfterUpload","Component"],"mappings":"+RAQqBA,G,uDACjB,WAAYC,GAAQ,IAAD,8BACf,cAAMA,IA2DRC,SAAW,SAAAC,GAAM,IAAD,EACUA,EAAEC,OAAlBC,EADM,EACNA,KAAMC,EADA,EACAA,MAEd,EAAKC,SAAL,eACGF,EAAOC,KA9DV,EAAKE,MAAQ,CACPC,SAAU,GACVC,IAAM,GACNC,gBAAkB,GAClBC,QAAU,KACVC,QAAU,MAEhB,EAAKC,OAAS,EAAKA,OAAOC,KAAZ,gBATC,E,mDAYVC,EAAcC,GACnBC,KAAKX,SAAS,CACZE,SAAWO,EACXN,IAAMO,M,0CAKUR,GAClB,OAAIA,GAAgC,IAApBA,EAASU,OAejBV,EAASW,KAAK,SAAAC,GAClB,OACM,4BACE,2BAAIA,EAAMhB,UAhBpB,6BACE,6GACA,kBAAC,IAAD,CACEiB,UAAU,EACVC,WAAW,gBACXrB,SAAUgB,KAAKJ,OACfU,aAAc,CAAC,OAAQ,OAAQ,OAAQ,QAAS,QAChDC,MAAO,eACPC,YAAa,c,sCAeLhB,GACd,GAAIA,GAAsB,IAAfA,EAAIS,OAGf,OAAQT,EAAIU,KAAK,SAAAO,GACb,OACE,wBAAIC,MAAO,CAACC,UAAU,SACpB,yBAAKC,IAAKH,EAAKC,MAAO,CAACG,MAAO,gB,gCAe9BC,EAAKC,EAAWC,GACxB,IAAIxB,EAAM,IAAIyB,MACdzB,EAAIwB,QAAUA,EACdxB,EAAI0B,OAAS,WACT,IAAIC,EAASC,SAASC,cAAc,UACpCF,EAAON,MAAQrB,EAAIqB,MACnBM,EAAOG,OAAS9B,EAAI8B,OACVH,EAAOI,WAAW,MACxBC,UAAUhC,EAAK,EAAG,EAAG2B,EAAON,MAAOM,EAAOG,QAC9CH,EAAOM,OAAOV,IAElBvB,EAAIoB,IAAME,I,uKAILd,KAAK0B,UAAU1B,KAAKV,MAAME,KAC7B,SAACmC,GACK,IAAIC,EAAMC,OAAOC,IAAIC,gBAAgBJ,GACrC,EAAKtC,SAAS,CAAEK,QAAUkC,IAC1B,EAAKI,yBACR,SAACC,GACAC,QAAQC,IAAI,WAAWF,M,kJAM7BC,QAAQC,IAAInC,KAAKV,MAAMI,SACvBM,KAAKoC,8B,6CAIL,OAA0B,OAAvBpC,KAAKV,MAAMI,QACL,uBAAGgB,MAAO,CAAC2B,MAAM,QAAjB,sHAGL,yBAAK3B,MAAO,CAACC,UAAU,SACrB,yBAAK2B,IAAI,KAAK1B,IAAKZ,KAAKV,MAAMI,QAASgB,MAAO,CAACG,MAAO,a,kCAO9D,OAAQb,KAAKX,SAAS,CAClBE,SAAU,GACVC,IAAM,GACNE,QAAU,S,kDAIc,IAAD,OACzBM,KAAKX,SAAS,CACZM,QAAU,gHAEe4C,IAAvBvC,KAAKV,MAAMK,SACP6C,YAAW,WACP,EAAKnD,SAAS,CACZM,QAAU,SAEb,O,+BAIH,IAAD,SACqCK,KAAKV,MAAzCC,EADD,EACCA,SAAUC,EADX,EACWA,IAAKE,EADhB,EACgBA,QAASC,EADzB,EACyBA,QAEhC,OACE,6BAEA,6BAEA,0BAAM8C,OAAO,GAAGC,OAAO,QACrB,kBAAC,IAAD,CAAUnC,MAAM,uFAAiBpB,KAAK,kBAAkBH,SAAUgB,KAAKhB,YAa3E,wBAAK2D,UAAU,eACZ3C,KAAK4C,oBAAoBrD,GACzBS,KAAK6C,gBAAgBrD,IAGxB,yBAAKmD,UAAU,mBACf,kBAAC,IAAD,CAAQG,QAAQ,4BAA4BC,QAAU,kBAAM,EAAKC,cAAjE,0DAC0B,MAAtBhD,KAAKV,MAAMI,SAAqB,6BACV,MAAtBM,KAAKV,MAAMI,SACT,kBAAC,IAAD,CAAQoD,QAAQ,4BAA4BC,QAAU,kBAAM,EAAKE,cAAjE,sEAEJ,6BACwB,MAAtBjD,KAAKV,MAAMI,SACX,uBAAGgB,MAAO,CAAE2B,MAAM,QAAS1B,UAAU,QAAShB,GAEhD,6BACAK,KAAKkD,qBAAqBxD,U,GA3KKyD","file":"static/js/24.a5245fa5.chunk.js","sourcesContent":["import React, { Component } from 'react'\r\nimport Button from 'react-bootstrap/Button';\r\nimport axios from 'axios'\r\nimport { getjwt } from '../helpers/jwt'\r\nimport ImageUploader from \"react-images-upload\"\r\nimport { MDBInput } from \"mdbreact\"\r\nimport Loadable from 'react-loadable'\r\n\r\nexport default class UploadImage extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = { \r\n              pictures: [] ,\r\n              img : [] ,\r\n              locationToSetup : '',\r\n              imgBLOB : null,\r\n              message : null,\r\n            };\r\n        this.onDrop = this.onDrop.bind(this);\r\n      }\r\n\r\n      onDrop(pictureFiles, pictureDataURLs) {\r\n        this.setState({\r\n          pictures : pictureFiles,\r\n          img : pictureDataURLs,\r\n        });\r\n\r\n      }\r\n\r\n      showNameImageUpload(pictures){\r\n        if(!pictures || pictures.length === 0){\r\n          return (\r\n          <div>\r\n            <p>อัพโหลดรูปภาพ</p>\r\n            <ImageUploader\r\n              withIcon={true}\r\n              buttonText=\"Choose images\"\r\n              onChange={this.onDrop}\r\n              imgExtension={[\".jpg\", \".gif\", \".png\", \".jpeg\", \".gif\"]}\r\n              label={\"Upload image\"}\r\n              maxFileSize={15189789}\r\n            />\r\n          </div>\r\n            )\r\n        } else {\r\n        return  pictures.map( image => {\r\n            return (\r\n                  <li>\r\n                    <p>{image.name}</p>\r\n                  </li>\r\n            )\r\n          })\r\n        }\r\n      }\r\n\r\n      showImageUpload(img){\r\n        if(!img || img.length === 0){\r\n\r\n        } else {\r\n        return  img.map( pic => {\r\n            return (\r\n              <li style={{marginTop:'20px'}}>\r\n                <img src={pic} style={{width: '100%'}}/>\r\n              </li>\r\n            )\r\n          })\r\n        }\r\n      }\r\n\r\n      onChange = e => {\r\n        const { name, value } = e.target\r\n    \r\n        this.setState({\r\n          [name]: value\r\n        })\r\n      }\r\n\r\n      b64toBlob(b64, onsuccess, onerror) {\r\n        var img = new Image();\r\n        img.onerror = onerror;\r\n        img.onload = function onload() {\r\n            var canvas = document.createElement('canvas');\r\n            canvas.width = img.width;\r\n            canvas.height = img.height;\r\n            var ctx = canvas.getContext('2d');\r\n            ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\r\n            canvas.toBlob(onsuccess);\r\n        };\r\n        img.src = b64;\r\n    }\r\n\r\n    async  sendImage(){\r\n      await  this.b64toBlob(this.state.img,\r\n          (blob) => {\r\n                var url = window.URL.createObjectURL(blob);\r\n                this.setState({ imgBLOB : url })\r\n                this.sentImageToDatabase()\r\n          }, (error) => {\r\n              console.log(\"error = \"+error)\r\n          });\r\n\r\n      }\r\n\r\n      sentImageToDatabase(){\r\n        console.log(this.state.imgBLOB)\r\n        this.showMessageUploadComplete()\r\n      }\r\n\r\n      showImageAfterUpload(){\r\n        if(this.state.imgBLOB === null){\r\n          return <p style={{color:'red'}} >ยังไม่ได้อัพโหลดรูป</p>\r\n        } else {\r\n          return (\r\n            <div style={{marginTop:'20px'}}>\r\n              <img alt=\"ds\" src={this.state.imgBLOB} style={{width: '100%'}}/>\r\n            </div>\r\n          )\r\n        }\r\n      }\r\n\r\n      editImage(){\r\n      return  this.setState({\r\n          pictures: [] ,\r\n          img : [] ,\r\n          imgBLOB : null\r\n        })\r\n      }\r\n\r\n      showMessageUploadComplete(){\r\n        this.setState({\r\n          message : 'อัพโหลดรูปภาพแล้ว'\r\n        })\r\n        if( this.state.message !== undefined ){\r\n                setTimeout(() => {\r\n                    this.setState({\r\n                      message : null\r\n                    }) \r\n                }, 3000);\r\n        }   \r\n    }\r\n\r\n      render() {\r\n        const { pictures, img, imgBLOB, message } = this.state\r\n\r\n        return (\r\n          <div>\r\n          \r\n          <div>\r\n          \r\n          <form action=\"\" method=\"post\">\r\n            <MDBInput label=\"สถานที่ติดตั้ง\" name=\"locationToSetup\" onChange={this.onChange}/>\r\n          </form>\r\n\r\n      {/*  <ImageUploader\r\n        withIcon={true}\r\n        buttonText=\"Choose images\"\r\n        onChange={this.onDrop}\r\n        imgExtension={[\".jpg\", \".gif\", \".png\", \".jpeg\", \".gif\"]}\r\n        label={\"Upload image\"}\r\n        maxFileSize={5242880}\r\n        />\r\n      */}\r\n        \r\n        <ul  className=\"list-inline\">\r\n          {this.showNameImageUpload(pictures)}\r\n          {this.showImageUpload(img)}\r\n        </ul>\r\n\r\n        <div className=\"container-fluid\">\r\n        <Button variant=\"btn btn-block btn-success\" onClick={ () => this.sendImage()}>ส่งรูปภาพ</Button>\r\n          { this.state.imgBLOB != null &&  (<br />) }\r\n          { this.state.imgBLOB != null && (\r\n              <Button variant=\"btn btn-block btn-warning\" onClick={ () => this.editImage()}>แก้ไขรูปภาพ</Button>\r\n          ) }\r\n          <br />\r\n          { this.state.imgBLOB != null &&  (\r\n            <p style={{ color:'green', marginTop:'3px'}}>{message}</p>\r\n          ) }\r\n          <br />\r\n        { this.showImageAfterUpload(imgBLOB) }\r\n        </div>\r\n          \r\n        </div>\r\n        </div>\r\n        )\r\n      }\r\n}\r\n"],"sourceRoot":""}
{"version":3,"sources":["components/helpers/removeLocal.js","components/maintenance/MaintenanceThree.js","components/helpers/Ip.js"],"names":["module","exports","removeDataLocalStorage","localStorage","removeItem","IPModule","require","RemoveLocal","MaintenanceThree","props","onChange","e","target","name","value","setState","handleRate","a","rating","addNumbwe","showText","valueStar","state","messageRating","clear","sigPad","imgSignatureBLOB","trim","convertImageToBlob","id","locationToSetup","imgBLOB","problem","fixed","message","SignatureName","suggestion","jwt","getjwt","this","history","push","axios","get","getIP","headers","then","res","data","rows","catch","err","b64","onsuccess","onerror","img","Image","onload","canvas","document","createElement","width","height","getContext","drawImage","toBlob","src","imgs","getTrimmedCanvas","toDataURL","b64toBlob","blob","url","window","URL","createObjectURL","error","console","log","uploadImage","getItem","teamID","setTimeout","method","style","marginTop","color","label","maxRating","icon","size","onRate","className","canvasProps","backgroundColor","ref","variant","onClick","sendDataThree","showMessageUpload","alt","Component"],"mappings":"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","file":"static/js/20.7cb70510.chunk.js","sourcesContent":["module.exports.removeDataLocalStorage = function(){\r\n    localStorage.removeItem('user')\r\n    localStorage.removeItem( 'user_id')\r\n    localStorage.removeItem('teamproject_ID')\r\n}","import React, { Component } from 'react'\r\nimport { MDBInput } from \"mdbreact\"\r\nimport Button from 'react-bootstrap/Button'\r\nimport { Rating } from 'semantic-ui-react'\r\nimport SignaturePad from 'react-signature-canvas'\r\nimport axios from 'axios'\r\nimport { getjwt } from '../helpers/jwt'\r\nimport './styles.module.sig.css'\r\n\r\nvar IPModule = require('../helpers/Ip')\r\nvar RemoveLocal = require('../helpers/removeLocal')\r\n\r\nexport default class MaintenanceThree extends Component {\r\n    constructor(props){\r\n        super(props)\r\n        this.state={\r\n            id : ' ',\r\n            locationToSetup : ' ',\r\n            imgBLOB : ' ',\r\n            problem : 'ปัญหาที่พบเจอขณะติดตั้ง',\r\n            fixed : 'วิธีแก้ไข',\r\n            message : null,\r\n\r\n            SignatureName: 'ชื่อผู้ดูแลสถานที่ติดตั้ง',\r\n            valueStar : ' ',\r\n            messageRating : 'โปรดประเมินการติดตั้ง',\r\n            suggestion : 'ข้อเสนอแนะ',\r\n            imgSignatureBLOB : null\r\n        }\r\n    }\r\n\r\n    async componentDidMount(){\r\n      const jwt = getjwt()\r\n      if(!jwt) {\r\n          this.props.history.push('/login')\r\n      }\r\n      axios.get(`${IPModule.getIP()}:3000/api/v1/posts` , \r\n      { \r\n          headers : { 'x-access-token' : jwt  } \r\n      })\r\n      .then( res => {\r\n          if( res.data.rows[0].data[0].SignatureName && res.data.rows[0].data[0].valueStar ){\r\n              this.setState({\r\n                  id : res.data.rows[0].id,\r\n                  locationToSetup : res.data.rows[0].data[0].locationToSetup,\r\n                  imgBLOB : res.data.rows[0].data[0].imgBLOB,\r\n                  problem : res.data.rows[0].data[0].problem,\r\n                  fixed : res.data.rows[0].data[0].fixed,\r\n\r\n                  SignatureName : res.data.rows[0].data[0].SignatureName,\r\n                  valueStar : res.data.rows[0].data[0].valueStar,\r\n                  messageRating : res.data.rows[0].data[0].messageRating,\r\n                  suggestion : res.data.rows[0].data[0].suggestion,\r\n                  imgSignatureBLOB : res.data.rows[0].data[0].imgSignatureBLOB\r\n              })\r\n          } else {\r\n              this.setState({\r\n                  id : res.data.rows[0].id,\r\n                  locationToSetup : res.data.rows[0].data[0].locationToSetup,\r\n                  imgBLOB : res.data.rows[0].data[0].imgBLOB,\r\n                  problem : res.data.rows[0].data[0].problem,\r\n                  fixed : res.data.rows[0].data[0].fixed,\r\n              })\r\n          }\r\n\r\n      }).catch( err => {\r\n          RemoveLocal.removeDataLocalStorage()\r\n          this.props.history.push('/login')\r\n      })\r\n      \r\n  }\r\n\r\n    onChange = e => {\r\n      const { name, value } = e.target\r\n      this.setState({\r\n        [name]: value\r\n      })\r\n    }\r\n\r\n    handleRate = async (e, { rating }) =>{\r\n      await this.addNumbwe(e, { rating })\r\n            this.showText()\r\n    }\r\n  \r\n    addNumbwe = (e, { rating }) => {\r\n      this.setState({ valueStar : rating })\r\n    }\r\n  \r\n    showText = () =>{\r\n          switch (this.state.valueStar){\r\n            case 5 :\r\n              return this.setState({ messageRating : \"ประทับใจ\" })\r\n              break\r\n            case 4 :\r\n              return this.setState({ messageRating : \"ดีมาก\" }) \r\n              break\r\n            case 3 :\r\n              return this.setState({ messageRating : \"ดี\" }) \r\n              break\r\n            case 2 :\r\n              return this.setState({ messageRating : \"พอใช้\" }) \r\n              break\r\n            case 1 :\r\n              return this.setState({ messageRating : \"ต้องปรับปรุง\" }) \r\n              break\r\n            default:\r\n              return null\r\n          }\r\n    }\r\n\r\n    clear = () => {\r\n      this.sigPad.clear()\r\n      this.setState({\r\n        imgSignatureBLOB: null\r\n      })\r\n    }\r\n    trim = () => {\r\n      this.convertImageToBlob()\r\n    }\r\n\r\n    b64toBlob(b64, onsuccess, onerror) {\r\n      var img = new Image();\r\n      img.onerror = onerror;\r\n      img.onload = function onload() {\r\n          var canvas = document.createElement('canvas');\r\n          canvas.width = img.width;\r\n          canvas.height = img.height;\r\n          var ctx = canvas.getContext('2d');\r\n          ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\r\n          canvas.toBlob(onsuccess);\r\n      };\r\n      img.src = b64;\r\n    }\r\n\r\n  async  convertImageToBlob(){\r\n    var imgs = this.sigPad.getTrimmedCanvas().toDataURL('image/jpg')\r\n    await  this.b64toBlob( imgs ,\r\n        (blob) => {\r\n              var url = window.URL.createObjectURL(blob);\r\n              this.setState({ imgSignatureBLOB : url })\r\n        }, (error) => {\r\n            console.log(\"error = \"+error)\r\n        });\r\n    }\r\n\r\n    async  sendDataThree(){\r\n      await  this.trim()\r\n      await  this.uploadImage() \r\n    }\r\n\r\n  async  uploadImage(){\r\n      const teamID = await localStorage.getItem('teamproject_ID')\r\n      const jwt = await getjwt()\r\n        if(!jwt) {\r\n            this.props.history.push('/login')\r\n        }\r\n      setTimeout(() => {\r\n        axios({\r\n          method: 'put',\r\n          url: `${IPModule.getIP()}:3000/api/v1/posts/${this.state.id}`,\r\n          headers : { 'x-access-token' : jwt  } ,\r\n            data: {\r\n              \"project_pair_key\" : `${teamID}`,\r\n              \"data\" : {\r\n                      \"locationToSetup\" : `${this.state.locationToSetup}`,\r\n                      \"imgBLOB\" : `${this.state.imgBLOB}`,\r\n                      \"problem\" : `${this.state.problem}`,\r\n                      \"fixed\" : `${this.state.fixed}`,\r\n                      \"SignatureName\" : `${this.state.SignatureName}`,\r\n                      \"valueStar\" : `${this.state.valueStar}`,\r\n                      \"messageRating\" : `${this.state.messageRating}`,\r\n                      \"suggestion\" : `${this.state.suggestion}`,\r\n                      \"imgSignatureBLOB\" : `${this.state.imgSignatureBLOB}`,\r\n              }\r\n          }\r\n        }).then( res => {\r\n          this.setState({\r\n            message : 'ส่งข้อมูลสำเร็จ'\r\n          })\r\n        }).catch( error => {\r\n\r\n          this.setState({\r\n            message : 'ส่งข้อมูลไม่สำเร็จ'\r\n          })\r\n          \r\n        })\r\n\r\n      }, 500);\r\n    }\r\n\r\n    showMessageUpload(){\r\n      if(this.state.message){\r\n        if(this.state.message === \"ส่งข้อมูลสำเร็จ\"){\r\n            return <p style={{ marginTop:'3px', color:'green' }} >{this.state.message}</p>\r\n        } else if(this.state.message === \"ส่งข้อมูลไม่สำเร็จ\"){\r\n            return <p style={{ marginTop:'3px', color:'red' }} >{this.state.message}</p>\r\n        } else {\r\n            return <p style={{ marginTop:'3px', color:'red' }} >internet error</p>\r\n        }\r\n      }\r\n\r\n    }\r\n\r\n    render () {\r\n      const { messageRating, imgSignatureBLOB} = this.state\r\n\r\n      return(\r\n        <div>\r\n\r\n        <form>\r\n          <MDBInput label={`${this.state.SignatureName}`} name=\"SignatureName\" onChange={this.onChange}/>\r\n        </form>\r\n          <br />\r\n          <div>\r\n          {messageRating}\r\n        </div>\r\n        <div>\r\n          <Rating maxRating={5} icon='star' size='massive' onRate={this.handleRate}/>\r\n        </div>\r\n        <form>\r\n        <MDBInput label={`${this.state.suggestion}`} name=\"suggestion\" onChange={this.onChange}/>\r\n        </form>\r\n\r\n        <form>\r\n        <div className=\"container\">\r\n          <div className=\"sigContainer\">\r\n            <SignaturePad \r\n              canvasProps={{className: \"sigPad\"}}\r\n              backgroundColor = '#ffffcc'\r\n              ref={(ref) => { this.sigPad = ref }} \r\n            />\r\n          </div>\r\n        </div>\r\n        <br />\r\n          <div className=\"container-fluid\">\r\n            <Button variant=\"btn btn-block btn-warning\" onClick={() => this.clear()} color=\"primary\"> แก้ไขลายเซ็น </Button>{' '}\r\n          </div>\r\n        </form>\r\n        <br />\r\n          <div className=\"container-fluid\">\r\n            <Button variant=\"btn btn-block btn-success\" onClick={() => this.sendDataThree()} color=\"primary\"> ส่งชื่อ </Button>{' '}\r\n            <br />\r\n            {this.showMessageUpload()}\r\n          </div>\r\n        <br />\r\n        <div className=\"container-fluid\">\r\n        { this.state.imgSignatureBLOB &&  ( <img  className=\"sigImage\" alt=\"signature\" src={imgSignatureBLOB} /> ) }\r\n        </div>\r\n        \r\n      </div>\r\n      )\r\n    }\r\n  }","module.exports.getIP = function(){\r\n    return 'http://54.254.61.44'\r\n}"],"sourceRoot":""}
(this.webpackJsonp2fast=this.webpackJsonp2fast||[]).push([[22],{453:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return k}));var n=a(97),o=a.n(n),r=a(99),s=a(44),i=a(14),c=a(13),l=a(18),u=a(16),m=a(15),h=a(0),p=a.n(h),g=a(120),f=a(57),d=a.n(f),v=a(49),b=a(454),w=a.n(b),I=a(133),y=(a(7),a(53)),E=a(50),k=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).onChange=function(e){var t=e.target,a=t.name,o=t.value;n.setState(Object(s.a)({},a,o))},n.state={pictures:[],img:[],locationToSetup:"",imgBLOB:null,message:null},n.onDrop=n.onDrop.bind(Object(l.a)(n)),n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=Object(r.a)(o.a.mark((function e(){var t,a,n=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=Object(v.a)())||this.props.history.push("/login"),e.next=4,localStorage.getItem("teamproject_ID");case 4:a=e.sent,d.a.get("".concat(y.getIP(),":5003/api/v1/projectjob/").concat(a),{headers:{"x-access-token":t}}).then((function(e){})).catch((function(e){E.removeDataLocalStorage(),n.props.history.push("/login")}));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onDrop",value:function(e,t){this.setState({pictures:e,img:t})}},{key:"showNameImageUpload",value:function(e){return e&&0!==e.length?e.map((function(e){return p.a.createElement("p",null,e.name)})):p.a.createElement("div",null,p.a.createElement("p",null,"\u0e2d\u0e31\u0e1e\u0e42\u0e2b\u0e25\u0e14\u0e23\u0e39\u0e1b\u0e20\u0e32\u0e1e"),p.a.createElement(w.a,{withIcon:!0,buttonText:"Choose images",onChange:this.onDrop,imgExtension:[".jpg",".gif",".png",".jpeg",".gif"],label:"Upload image",maxFileSize:15189789}))}},{key:"showImageUpload",value:function(e){if(e&&0!==e.length)return e.map((function(e){return p.a.createElement("li",{style:{marginTop:"20px"}},p.a.createElement("img",{src:e,style:{width:"100%"}}))}))}},{key:"b64toBlob",value:function(e,t,a){var n=new Image;n.onerror=a,n.onload=function(){var e=document.createElement("canvas");e.width=n.width,e.height=n.height,e.getContext("2d").drawImage(n,0,0,e.width,e.height),e.toBlob(t)},n.src=e}},{key:"sendImage",value:function(){var e=Object(r.a)(o.a.mark((function e(){var t=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.b64toBlob(this.state.img,(function(e){var a=window.URL.createObjectURL(e);t.setState({imgBLOB:a}),t.sentImageToDatabase()}),(function(e){console.log("error = "+e)}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"sentImageToDatabase",value:function(){var e=Object(r.a)(o.a.mark((function e(){var t,a,n=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,localStorage.getItem("teamproject_ID");case 2:return t=e.sent,e.next=5,Object(v.a)();case 5:(a=e.sent)||this.props.history.push("/login"),d()({method:"post",url:"".concat(y.getIP(),":3000/api/v1/posts/"),headers:{"x-access-token":a},data:{project_pair_key:"".concat(t),data:{locationToSetup:"".concat(this.state.locationToSetup),imageLocation:"".concat(this.state.imgBLOB)}}}).then((function(e){n.showImageAfterUpload(),n.showMessageUploadComplete(),console.log("pass "+e)})).catch((function(e){console.log("err "+e),n.showMessageUploadError()}));case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"showImageAfterUpload",value:function(){return null===this.state.imgBLOB?p.a.createElement("p",{style:{color:"red"}},"\u0e22\u0e31\u0e07\u0e44\u0e21\u0e48\u0e44\u0e14\u0e49\u0e2d\u0e31\u0e1e\u0e42\u0e2b\u0e25\u0e14\u0e23\u0e39\u0e1b"):p.a.createElement("div",{style:{marginTop:"20px"}},p.a.createElement("img",{alt:"ds",src:this.state.imgBLOB,style:{width:"100%"}}))}},{key:"editImage",value:function(){return this.setState({pictures:[],img:[],imgBLOB:null})}},{key:"showMessageUploadComplete",value:function(){var e=this;this.setState({message:"\u0e2d\u0e31\u0e1e\u0e42\u0e2b\u0e25\u0e14\u0e23\u0e39\u0e1b\u0e20\u0e32\u0e1e\u0e41\u0e25\u0e49\u0e27"}),void 0!==this.state.message&&setTimeout((function(){e.setState({message:null})}),3e3)}},{key:"showMessageUploadError",value:function(){var e=this;this.setState({message:"\u0e2d\u0e31\u0e1e\u0e42\u0e2b\u0e25\u0e14\u0e23\u0e39\u0e1b\u0e20\u0e32\u0e1e\u0e44\u0e21\u0e48\u0e2a\u0e33\u0e40\u0e23\u0e47\u0e08 \u0e42\u0e1b\u0e23\u0e14\u0e2d\u0e31\u0e1e\u0e42\u0e2b\u0e25\u0e14\u0e43\u0e2b\u0e21\u0e48"}),setTimeout((function(){e.setState({message:null})}),3e3)}},{key:"render",value:function(){var e=this,t=this.state,a=t.pictures,n=t.img,o=t.imgBLOB,r=t.message;return p.a.createElement("div",null,p.a.createElement("div",null,p.a.createElement("form",{action:"",method:"post"},p.a.createElement(I.i,{label:"\u0e2a\u0e16\u0e32\u0e19\u0e17\u0e35\u0e48\u0e15\u0e34\u0e14\u0e15\u0e31\u0e49\u0e07",name:"locationToSetup",onChange:this.onChange})),p.a.createElement("ul",{className:"list-inline"},this.showNameImageUpload(a),this.showImageUpload(n)),p.a.createElement("div",{className:"container-fluid"},p.a.createElement(g.a,{variant:"btn btn-block btn-success",onClick:function(){return e.sendImage()}},"\u0e2a\u0e48\u0e07\u0e23\u0e39\u0e1b\u0e20\u0e32\u0e1e"),null!=this.state.imgBLOB&&p.a.createElement("br",null),null!=this.state.imgBLOB&&p.a.createElement(g.a,{variant:"btn btn-block btn-warning",onClick:function(){return e.editImage()}},"\u0e41\u0e01\u0e49\u0e44\u0e02\u0e23\u0e39\u0e1b\u0e20\u0e32\u0e1e"),p.a.createElement("br",null),null!=this.state.imgBLOB&&p.a.createElement("p",{style:{marginTop:"3px"}},r),p.a.createElement("br",null),this.showImageAfterUpload(o))))}}]),a}(h.Component)},50:function(e,t){e.exports.removeDataLocalStorage=function(){localStorage.removeItem("user"),localStorage.removeItem("user_id"),localStorage.removeItem("teamproject_ID")}},53:function(e,t){e.exports.getIP=function(){return"http://54.254.61.44"}}}]);
//# sourceMappingURL=22.1ef2f709.chunk.js.map